\section{Results}
We demonstrated the performance of our algorithm using released influenza hemagglutinin
data set \philbs \ and a serum glycan data set\rphumanserum. Please refer to section
S\ref{S-sec:algorithm_performance} for all other datasets. For each comparison, the
unregularized case is not smoothed, effectively $\lambda = 0$, the partially regularized
case uses the grid search fitted values of $\mathbf{\tau}$ but uses a fixed $\lambda = 0.2$,
and the fully regularized case uses the grid search fitted values of both $\mathbf{\tau}$
and $\lambda$.

\input{philbsstats}
\input{Serum}

\subsection{Chromatogram Assignment Performance for \philbs}
    The fitted parameters for the network constructed for \philbs are shown in
    Table~\ref{tab:parameter_estimates}. The assigned chromatograms are shown in
    Figure~\ref{fig:philbs_assignments}. We observe up to seven branch structures in
    this sample, consistent with these \nglycans being derived from an avian context
    (\cite{Stanley2009,Khatri2016a}).

    \begin{table}[tb]
        \centering
        \small
        \begin{tabular}{l SSSSSS}
            \toprule
            \multirow{2}{*}{Neighborhood $\tau$} &
                \multicolumn{3}{c}{Phil-BS} &
                \multicolumn{3}{c}{Serum} \\
                & {Combinatorial + Sulfate} & {\glyspace} & {Krambeck} & {Combinatorial} & {\glyspace} & {Krambeck}\\
            \midrule
            high-mannose           & 18.010 & 16.949 & 17.001 & 20.148 & 19.568 & 19.720\\
            hybrid                 & 13.378 & 15.418 & 13.700 & 19.889 & 18.963 & 20.056\\
            bi-antennary           & 0.000  & 0.000  & 0.000  & 16.654 & 13.808 & 17.594\\
            asialo-bi-antennary    & 14.135 & 12.708 & 12.913 & 22.221 & 21.852 & 21.827\\
            tri-antennary          & 0.000  & 0.000  & 0.000  & 24.600 & 19.313 & 23.644\\
            asialo-tri-antennary   & 14.476 & 10.918 & 10.823 & 20.474 & 20.514 & 19.764\\
            tetra-antennary        & 0.000  & 0.000  & 0.000  & 18.630 & 18.438 & 17.675\\
            asialo-tetra-antennary & 14.351 & 0.000  & 6.186  & 4.118  & 5.437  & 2.568\\
            penta-antennary        & 0.000  & 0.000  & 0.000  & 12.822 & 14.383 & 11.681\\
            asialo-penta-antennary & 11.582 & 0.000  & 4.892  & 0.000  & 0.000  & 0.000\\
            hexa-antennary         & 0.000  & 0.000  & 0.000  & 0.000  & 0.000  & 0.000\\
            asialo-hexa-antennary  & 11.089 & 0.000  & 6.612  & 0.000  & 0.000  & 0.000\\
            hepta-antennary        & 0.000  & 0.000  & 0.000  & 0.000  & 0.000  & 0.000\\
            asialo-hepta-antennary & 3.120  & 0.000  & 1.351  & 0.000  & 0.000  & 0.000\\
            \midrule
            ${\hat \lambda}$       & 0.99   & 0.99   & 0.99   & 0.99   & 0.99   & 0.99\\
            ${\hat \gamma}$        & 11.39  & 18.35  & 14.42  & 19.32  & 19.37  & 20.67\\
            \bottomrule
        \end{tabular}
        \caption{Estimated values of smoothing parameters $\tau$, $\lambda$, and $\gamma$ for each
                 dataset and database\label{tab:parameter_estimates}}
    \end{table}

    \begin{figure}[tb]
        \caption{Chromatogram Assignments and Quantification
                 for \philbs Using the \textit{Combinatorial + Sulfate} database.
                 \label{fig:philbs_assignments}}
        \centering
        \includegraphics[width=0.45\textwidth,valign=t]{figure/sulfated_phil_bs_native_chromatograms.pdf}
        \includegraphics[width=0.45\textwidth,valign=t]{figure/sulfated_phil_bs_native_abundances.pdf}
    \end{figure}

    \begin{figure}[tb]
        \caption{Performance Comparison with and without Network Smoothing for \philbs
                 \label{fig:philbs_perf}}
        \centering
        \includegraphics[width=0.45\textwidth,valign=t]{figure/sulfated_phil_bs_native_roc.pdf}
        \includegraphics[width=0.45\textwidth,valign=t]{figure/sulfated_phil_bs_native_prec_rec.pdf}
    \end{figure}

    \begin{table}[tb]
        \small
        \centering
        \begin{threeparttable}
            \begin{tabular}{l S c}
                \toprule
                Name & {ROC AUC} & True Matches \tnote{1} \\
                \midrule
                Combinatorial Unregularized & \PhilBSStatsCombinatorialUnregularizedROCAUC &
                                              \PhilBSStatsCombinatorialUnregularizedTotal \\
                Combinatorial Partial       & \PhilBSStatsCombinatorialPartialROCAUC &
                                              \PhilBSStatsCombinatorialPartialTotal \\
                Combinatorial Grid          & \PhilBSStatsCombinatorialGridROCAUC &
                                              \PhilBSStatsCombinatorialGridTotal \\
                GlySpace Unregularized      & \PhilBSStatsGlyspaceUnregularizedROCAUC &
                                              \PhilBSStatsGlyspaceUnregularizedTotal \\
                GlySpace Partial            & \PhilBSStatsGlyspacePartialROCAUC &
                                              \PhilBSStatsGlyspacePartialTotal \\
                GlySpace Grid               & \PhilBSStatsGlyspaceGridROCAUC &
                                              \PhilBSStatsGlyspaceGridTotal \\
                Krambeck Unregularized      & \PhilBSStatsKrambeckUnregularizedROCAUC &
                                              \PhilBSStatsKrambeckUnregularizedTotal \\
                Krambeck Partial            & \PhilBSStatsKrambeckPartialROCAUC &
                                              \PhilBSStatsKrambeckPartialTotal \\
                Krambeck Grid               & \PhilBSStatsKrambeckGridROCAUC &
                                              \PhilBSStatsKrambeckGridTotal \\
                \cite{Khatri2016a} & {-} & 46 \\
                \bottomrule
            \end{tabular}
            \begin{tablenotes}
                \item[1] Selected at $\phi_o > 5.0$
            \end{tablenotes}
            \caption{Performance Comparison for \philbs\label{tab:philbs_statistics}}
        \end{threeparttable}
    \end{table}

    The comparison of assignment performance with differing degrees of smoothing for each database
    are shown in Figure~\ref{fig:philbs_perf} and Table \ref{tab:philbs_statistics}. We observed the
    greatest number of assignments using the combinatorial database including sulfate.

\subsection{Chromatogram Assignment Performance for \rpserum}
    The fitted parameters for the network constructed for \rpserum are shown in
    Table~\ref{tab:parameter_estimates}. The assigned chromatograms are shown in
    Figure~\ref{fig:rpserum_assignments}.

    \begin{figure}[tb]
        \centering
        \begin{minipage}{1\linewidth}
            \centering
            \includegraphics[width=1\linewidth, valign=t]{figure/rp_serum_chromatograms.pdf}
            \subcaption{
                % Features Assigned After Grid Regularization of \rpserum.
                \label{fig:rpserum_assignment:a}
            }
        \end{minipage}
        \begin{minipage}{1\linewidth}
            \centering
            \begin{subfigure}[t]{0.49\linewidth}
                \includegraphics[width=1\linewidth, valign=b]{figure/fucosylated_tetra_antennary_structures.pdf}
                \subcaption{
                    % Low scoring features which may be discarded based on individual evidence alone
                    % may be more reasonable to accept given evidence from related composition, such
                    % as our network smoothing method.
                    \label{fig:rpserum_assignment:b}
                }
            \end{subfigure}
            \vspace{0pt}
            \begin{subfigure}[t]{0.49\linewidth}
                \includegraphics[width=1\linewidth, valign=b]{figure/ammonium_adduct_ambiguity.pdf}
                \subcaption{
                    % This sample contains heavy ammonium adduction which introduces ambiguity
                    % in intact mass based assignments.
                    \label{fig:rpserum_assignment:c}
                }
            \end{subfigure}
        \end{minipage}
        \caption{Chromatogram Assignments for \rpserum
            (a) Features Assigned After Grid Regularization of \rpserum (b) Low scoring features
            which may be discarded based on individual evidence alone may be more reasonable to accept
            given evidence from related composition, such as our network smoothing method (c) This sample
            contains heavy ammonium adduction which introduces ambiguity in intact mass based assignments
            \label{fig:rpserum_assignments}
        }
    \end{figure}

    \begin{figure}[htb]
        \caption{Performance Comparison with and without Network Smoothing for \rpserum
                 \label{fig:rpserum_perf}}
        \centering
        \includegraphics[width=0.45\textwidth,valign=t]{figure/serum_roc.pdf}
        \includegraphics[width=0.45\textwidth,valign=t]{figure/serum_prec_rec.pdf}
    \end{figure}

    The comparison of assignment performance with differing degrees of smoothing is
    shown in Figure~\ref{fig:rpserum_perf}. We observe the greatest number of total true
    identifications using the partially regularized Combinatorial database. However, the
    Combinatorial database also has many more false positives, with a ROC AUC of \SerumCombinatorialPartialROCAUC.
    These false positives do not appear in the biosynthetically constraind Krambeck database
    which maximizes its ROC AUC in the partially regularized condition at \SerumKrambeckPartialROCAUC.
    After removing all ambiguous matches, the Krambeck database also has nearly the same
    number of true matches as the Combinatorial database.

    \begin{table}
        \small
        \centering
        \begin{threeparttable}
            \begin{tabular}{l S c c}
                \toprule
                Name & {ROC AUC} & True Matches \tnote{1} & Non-Ambiguous Matches\\
                \midrule
                Combinatorial Unregularized & \SerumCombinatorialUnregularizedROCAUC &
                                              \SerumCombinatorialUnregularizedTotal &
                                              \SerumCombinatorialUnregularizedTotalSimplified \\
                Combinatorial Partial       & \SerumCombinatorialPartialROCAUC &
                                              \SerumCombinatorialPartialTotal &
                                              \SerumCombinatorialPartialTotalSimplified \\
                Combinatorial Grid          & \SerumCombinatorialGridROCAUC &
                                              \SerumCombinatorialGridTotal &
                                              \SerumCombinatorialGridTotalSimplified \\
                GlySpace Unregularized      & \SerumGlyspaceUnregularizedROCAUC &
                                              \SerumGlyspaceUnregularizedTotal &
                                              \SerumGlyspaceUnregularizedTotalSimplified \\
                GlySpace Partial            & \SerumGlyspacePartialROCAUC &
                                              \SerumGlyspacePartialTotal &
                                              \SerumGlyspacePartialTotalSimplified \\
                GlySpace Grid               & \SerumGlyspaceGridROCAUC &
                                              \SerumGlyspaceGridTotal &
                                              \SerumGlyspaceGridTotalSimplified \\
                Krambeck Unregularized      & \SerumKrambeckUnregularizedROCAUC &
                                              \SerumKrambeckUnregularizedTotal &
                                              \SerumKrambeckUnregularizedTotalSimplified \\
                Krambeck Partial            & \SerumKrambeckPartialROCAUC &
                                              \SerumKrambeckPartialTotal &
                                              \SerumKrambeckPartialTotalSimplified \\
                Krambeck Grid               & \SerumKrambeckGridROCAUC &
                                              \SerumKrambeckGridTotal &
                                              \SerumKrambeckGridTotalSimplified \\
                \cite{Yu2013}               & {-} & 72\tnote{2} & 59 \\
                \bottomrule
            \end{tabular}
            \begin{tablenotes}
                \item[1] Selected at $\phi_o > 5.0$
                \item[2] This count only includes those cases where sufficient MS1 scans were available
                         for a direct comparison
            \end{tablenotes}
            \caption{Performance Comparison for \rpserum\label{tab:serum_statistics}}
        \end{threeparttable}
    \end{table}
